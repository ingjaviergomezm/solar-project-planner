import{r as me,a as ve}from"./react-vendor-C2Q8UJjI.js";import{r as ye,E as Ce}from"./pdf-vendor-BxqUp45k.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(t){if(t.ep)return;t.ep=!0;const i=r(t);fetch(t.href,i)}})();var X={exports:{}},H={};var te;function Pe(){if(te)return H;te=1;var a=me(),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,t=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function s(d,n,l){var m,p={},x=null,u=null;l!==void 0&&(x=""+l),n.key!==void 0&&(x=""+n.key),n.ref!==void 0&&(u=n.ref);for(m in n)c.call(n,m)&&!i.hasOwnProperty(m)&&(p[m]=n[m]);if(d&&d.defaultProps)for(m in n=d.defaultProps,n)p[m]===void 0&&(p[m]=n[m]);return{$$typeof:o,type:d,key:x,ref:u,props:p,_owner:t.current}}return H.Fragment=r,H.jsx=s,H.jsxs=s,H}var ie;function we(){return ie||(ie=1,X.exports=Pe()),X.exports}var e=we(),_=me(),Y={},se;function Se(){if(se)return Y;se=1;var a=ve();return Y.createRoot=a.createRoot,Y.hydrateRoot=a.hydrateRoot,Y}var Ae=Se();const Me=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ee=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(o,r,c)=>c?c.toUpperCase():r.toLowerCase()),ne=a=>{const o=Ee(a);return o.charAt(0).toUpperCase()+o.slice(1)},pe=(...a)=>a.filter((o,r,c)=>!!o&&o.trim()!==""&&c.indexOf(o)===r).join(" ").trim(),Ie=a=>{for(const o in a)if(o.startsWith("aria-")||o==="role"||o==="title")return!0};var Te={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Oe=_.forwardRef(({color:a="currentColor",size:o=24,strokeWidth:r=2,absoluteStrokeWidth:c,className:t="",children:i,iconNode:s,...d},n)=>_.createElement("svg",{ref:n,...Te,width:o,height:o,stroke:a,strokeWidth:c?Number(r)*24/Number(o):r,className:pe("lucide",t),...!i&&!Ie(d)&&{"aria-hidden":"true"},...d},[...s.map(([l,m])=>_.createElement(l,m)),...Array.isArray(i)?i:[i]]));const S=(a,o)=>{const r=_.forwardRef(({className:c,...t},i)=>_.createElement(Oe,{ref:i,iconNode:o,className:pe(`lucide-${Me(ne(a))}`,`lucide-${a}`,c),...t}));return r.displayName=ne(a),r};const Re=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],ue=S("award",Re);const ke=[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]],Fe=S("battery",ke);const Le=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],re=S("calculator",Le);const De=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$e=S("check",De);const Be=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Z=S("circle-alert",Be);const We=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ge=S("clock",We);const He=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],xe=S("dollar-sign",He);const ze=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],qe=S("file-down",ze);const Ue=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ke=S("file-text",Ue);const Ye=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],he=S("loader-circle",Ye);const Ve=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Je=S("map-pin",Ve);const Xe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ge=S("settings",Xe);const Ze=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],D=S("sparkles",Ze);const Qe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ea=S("star",Qe);const aa=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],fe=S("sun",aa);const oa=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ta=S("trending-up",oa);const ia=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],sa=S("x",ia);const na=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],be=S("zap",na);function ra({onOpenSettings:a}){return e.jsxs("header",{className:"sticky top-0 z-50 safe-area-top",children:[e.jsx("div",{className:"absolute inset-0 bg-dark-500/95 backdrop-blur-xl border-b border-cosmic-600/50"}),e.jsx("div",{className:"relative container mx-auto px-4 py-3 md:py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-gradient-to-br from-solar-500 to-solar-600 rounded-xl flex items-center justify-center shadow-glow-sm",children:e.jsx(fe,{className:"w-5 h-5 md:w-6 md:h-6 text-dark-500",strokeWidth:2.5})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gradient",children:"Solar Planner"}),e.jsx("p",{className:"text-[10px] md:text-xs text-cosmic-400 hidden sm:block",children:"Dimensionamiento y presupuestación solar"})]})]}),e.jsxs("button",{onClick:a,className:"group flex items-center gap-2 px-3 py-2 md:px-4 md:py-2.5 bg-cosmic-800/50 hover:bg-cosmic-700/60 text-cosmic-200 hover:text-white rounded-xl transition-all duration-300 border border-cosmic-700/50 hover:border-solar-500/50","aria-label":"Abrir configuración",children:[e.jsx(ge,{className:"w-5 h-5 transition-transform duration-300 group-hover:rotate-90"}),e.jsx("span",{className:"hidden md:inline font-medium text-sm",children:"Configuración"})]})]})})]})}const _e="https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent";async function ca(a,o,r){if(!r)throw new Error("API Key de Gemini no configurada");const c=ma(a,o);try{const t=await fetch(`${_e}?key=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:c}]}],generationConfig:{temperature:.7,maxOutputTokens:8192},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]})});if(!t.ok){const d=await t.json();throw new Error(`Error de API: ${d.error?.message||"Error desconocido"}`)}const i=await t.json();console.log("Gemini Response:",i),console.log("Finish Reason:",i.candidates[0]?.finishReason);const s=i.candidates[0]?.content?.parts[0]?.text;if(!s){const d=i.candidates[0]?.finishReason;throw new Error(`No se recibió respuesta de la API. Finish Reason: ${d}`)}return s}catch(t){throw console.error("Error al llamar a Gemini API:",t),t}}async function la(a,o,r){if(!r)throw new Error("API Key de Gemini no configurada");const c=da(a,o);try{const t=await fetch(`${_e}?key=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:c}]}],generationConfig:{temperature:.3,maxOutputTokens:8192},safetySettings:[{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]})});if(!t.ok){const n=await t.json();throw new Error(`Error de API: ${n.error?.message||"Error desconocido"}`)}const i=await t.json();console.log("Gemini Configuraciones Response:",i);let s=i.candidates[0]?.content?.parts[0]?.text;if(!s)throw new Error("No se recibió respuesta de la API");s=s.trim(),s.startsWith("```json")?s=s.slice(7):s.startsWith("```")&&(s=s.slice(3)),s.endsWith("```")&&(s=s.slice(0,-3)),s=s.trim();const d=JSON.parse(s);return ce(d.configuracionCalidad),ce(d.configuracionEconomica),console.log("Respuesta IA:",d),d}catch(t){throw console.error("Error al generar configuraciones IA:",t),t}}function ce(a){if(!a)return;const o=(r,c=0)=>{if(r==null)return c;const t=typeof r=="string"?parseFloat(r):Number(r);return isNaN(t)?c:t};if(a.panel&&(a.panel.potencia_w=o(a.panel.potencia_w,450),a.panel.eficiencia=o(a.panel.eficiencia,20),a.panel.precio_cop=o(a.panel.precio_cop,25e4),a.panel.garantia_anos=o(a.panel.garantia_anos,25),a.panel.dimensiones_m2=o(a.panel.dimensiones_m2,2.5)),a.inversor&&(a.inversor.potencia_kw=o(a.inversor.potencia_kw,5),a.inversor.eficiencia=o(a.inversor.eficiencia,97),a.inversor.precio_cop=o(a.inversor.precio_cop,3e6),a.inversor.garantia_anos=o(a.inversor.garantia_anos,10)),a.numPaneles=o(a.numPaneles,10),a.potenciaReal=o(a.potenciaReal,a.numPaneles*a.panel.potencia_w/1e3),!a.areaRequerida||isNaN(a.areaRequerida)){const r=a.panel.dimensiones_m2||2.5;a.areaRequerida=Math.round(a.numPaneles*r*10)/10}else a.areaRequerida=o(a.areaRequerida,a.numPaneles*2.5);if(!a.puntuacion||isNaN(a.puntuacion)){const r=Math.min(a.panel.eficiencia/25*40,40),c=Math.min(a.panel.garantia_anos/30*30,30),t=Math.min(a.inversor.eficiencia/98*30,30);a.puntuacion=Math.round(r+c+t)}else a.puntuacion=o(a.puntuacion,75)}function da(a,o){const{paneles:r,inversores:c}=o;return`Eres un ingeniero experto en energía solar fotovoltaica especializado en el mercado colombiano.
Tu tarea es analizar los catálogos de equipos y generar 2 configuraciones óptimas para este proyecto.

## DATOS DEL PROYECTO:
- Nombre: ${a.nombreProyecto||"Proyecto Solar"}
- Ciudad: ${a.ciudad||"Bogotá"} (HSP: ${a.hsp||4.5} h/día)
- Consumo mensual: ${a.consumoMensual} kWh/mes
- Tipo instalación: ${a.tipoInstalacion||"Residencial"}
- Presupuesto máximo: ${a.presupuestoMaximo?"$"+a.presupuestoMaximo.toLocaleString()+" COP":"No especificado"}
- Autonomía objetivo: ${a.autonomiaPct||100}%

## CATÁLOGO DE PANELES DISPONIBLES:
${JSON.stringify(r.slice(0,12),null,2)}

## CATÁLOGO DE INVERSORES DISPONIBLES:
${JSON.stringify(c.slice(0,12),null,2)}

## CÁLCULOS QUE DEBES REALIZAR:

1. **Energía diaria requerida** = (consumoMensual / 30) / (autonomiaPct/100)
2. **Potencia del sistema** = energiaDiaria / HSP / 0.85 (factor de pérdidas)
3. **Número de paneles** = potenciaSistema * 1000 / potenciaPanel
4. **Selección de inversor** = elegir uno con potencia ≥ potenciaSistema * 0.8 (ratio DC/AC ~1.2)

## GENERA 2 CONFIGURACIONES:

### CONFIGURACIÓN 1: CALIDAD Y CONFIABILIDAD
- Prioriza: eficiencia máxima, garantía extendida, tecnología TOPCon/N-Type, marcas premium
- Inversores: Fronius, SMA o Huawei
- Paneles: mayor eficiencia disponible

### CONFIGURACIÓN 2: MEJOR PRECIO
- Prioriza: menor costo total, buena relación precio/Wp
- Sin sacrificar calidad básica (solo Tier 1)
- Buscar el equilibrio óptimo precio/rendimiento

## FORMATO DE RESPUESTA (JSON ESTRICTO):

Responde ÚNICAMENTE con este JSON, sin texto adicional:

{
  "configuracionCalidad": {
    "tipo": "Máxima Calidad",
    "prioridad": "calidad",
    "panel": {
      "id": <número>,
      "marca": "<marca>",
      "modelo": "<modelo>",
      "potencia_w": <número>,
      "eficiencia": <número>,
      "precio_cop": <número>,
      "garantia_anos": <número>,
      "tecnologia": "<tipo>"
    },
    "numPaneles": <número calculado>,
    "potenciaReal": <número en kW>,
    "areaRequerida": <número en m²>,
    "inversor": {
      "id": <número>,
      "marca": "<marca>",
      "modelo": "<modelo>",
      "potencia_kw": <número>,
      "eficiencia": <número>,
      "precio_cop": <número>,
      "garantia_anos": <número>,
      "tipo": "<tipo>"
    },
    "puntuacion": <número entre 0-100>,
    "justificacionHTML": "<p>Párrafo explicando por qué esta configuración es ideal para calidad.</p><ul><li>Punto 1</li><li>Punto 2</li><li>Punto 3</li></ul><p><strong>Conclusión:</strong> texto</p>"
  },
  "configuracionEconomica": {
    "tipo": "Mejor Precio",
    "prioridad": "economia",
    "panel": { ... mismo formato ... },
    "numPaneles": <número>,
    "potenciaReal": <número en kW>,
    "areaRequerida": <número en m²>,
    "inversor": { ... mismo formato ... },
    "puntuacion": <número entre 0-100>,
    "justificacionHTML": "<p>Párrafo explicando por qué esta configuración ofrece el mejor valor.</p><ul><li>Punto 1</li><li>Punto 2</li><li>Punto 3</li></ul><p><strong>Ahorro vs calidad:</strong> texto</p>"
  },
  "comparativaHTML": "<table style='width:100%'><tr><th>Aspecto</th><th>Calidad</th><th>Económica</th></tr><tr><td>Inversión</td><td>$X COP</td><td>$Y COP</td></tr><tr><td>Eficiencia</td><td>X%</td><td>Y%</td></tr><tr><td>Garantía</td><td>X años</td><td>Y años</td></tr></table>"
}

IMPORTANTE:
- Los precios deben venir del catálogo, NO inventados
- Las justificaciones DEBEN ser HTML válido, no Markdown
- El numPaneles debe ser un número entero calculado correctamente
- La potenciaReal = numPaneles * potencia_panel / 1000`}function ma(a,o){const{nombreProyecto:r,tipoInstalacion:c,ciudad:t,hsp:i,consumoMensual:s,autonomiaPct:d,presupuestoMaximo:n,espacioLimitado:l}=a,{tipo:m,panel:p,numPaneles:x,potenciaReal:u,inversor:g,presupuesto:h,roi:P,bateria:M,capacidadBateria:w}=o,f=u/g.potencia_kw,N=x*(p.dimensiones?.area||2.5),b=u*i*365*(g.eficiencia/100)*.85,v=b/12/s*100,E=P.ahorroAnual/12,j=M?"Sí":"No";return`Eres un ingeniero especialista en energía solar fotovoltaica con experiencia 
en proyectos comerciales en Colombia. Analiza la siguiente configuración 
calculada y proporciona una recomendación ejecutiva profesional.

CONTEXTO DEL PROYECTO:
- Tipo de instalación: ${c}
- Ubicación: ${t}, Colombia (HSP promedio: ${i} h/día)
- Consumo energético: ${s} kWh/mes
- Autonomía objetivo: ${d}%
- Presupuesto disponible: $${n?n.toLocaleString("es-CO"):"No especificado"} COP
- Restricción de espacio: ${l?"Sí":"No"}
- Requiere baterías: ${j}

CONFIGURACIÓN TÉCNICA CALCULADA:
- Potencia del sistema: ${u.toFixed(2)} kWp
- Paneles seleccionados: ${x} unidades × ${p.marca} ${p.modelo} 
  (${p.potencia_w}W, eficiencia ${p.eficiencia}%)
- Inversor: ${g.marca} ${g.modelo} (${g.potencia_kw} kW, 
  eficiencia ${g.eficiencia}%)
- Relación DC/AC: ${f.toFixed(2)}
- Área de techo requerida: ${N.toFixed(1)} m²
- Producción anual estimada: ${b.toLocaleString("es-CO",{maximumFractionDigits:0})} kWh/año
- Cobertura del consumo: ${v.toFixed(1)}%

ANÁLISIS ECONÓMICO:
- Inversión total: $${h.inversionTotal.toLocaleString("es-CO")} COP
- Costo por Wp instalado: $${Math.round(h.costoPorWp).toLocaleString("es-CO")} COP/Wp
- Ahorro mensual estimado: $${E.toLocaleString("es-CO",{maximumFractionDigits:0})} COP
- Periodo de retorno simple: ${P.tiempoRetornoAnos} años

GENERA UN ANÁLISIS ESTRUCTURADO CON LOS SIGUIENTES APARTADOS:

**1. VALIDACIÓN DE LA CONFIGURACIÓN:**
Evalúa si la configuración es óptima o si requiere ajustes. Considera:
- Si la relación DC/AC está en rango ideal (1.1-1.3 para on-grid)
- Si el número de paneles es múltiplo adecuado para strings balanceados
- Si el inversor está subdimensionado o sobredimensionado
- Si el área de techo es realista para una instalación ${c}

**2. RECOMENDACIONES TÉCNICAS ESPECÍFICAS:**
Proporciona 2-3 ajustes concretos si aplican (de lo contrario, confirma 
que la configuración es adecuada):
- Cambio de modelo de panel (ej: "Considera paneles de 550W en vez de 425W 
  para reducir área y mano de obra")
- Ajuste en cantidad para optimizar configuración de strings
- Inversor alternativo si hay mejor opción técnica/económica
- Inclusión/exclusión de baterías según patrón de consumo

**3. CONSIDERACIONES CRÍTICAS DEL PROYECTO:**
Lista 3 aspectos técnicos o regulatorios que el cliente DEBE considerar:
- Riesgos técnicos (ej: sombreado, orientación óptima de techo)
- Requisitos normativos Colombia (RETIE, Resolución CREG, Ley 1715)
- Mantenimiento preventivo y garantías
- Condiciones climáticas específicas de ${t}

**4. ANÁLISIS DE VIABILIDAD ECONÓMICA:**
Valida si el costo está en rango de mercado y si el ROI es atractivo:
- Comparar costo/Wp contra benchmarks Colombia 2026: 
  * Residencial: 4,000-5,500 COP/Wp
  * Comercial: 3,500-4,800 COP/Wp
  * Industrial: 3,200-4,200 COP/Wp
- Evaluar si payback < 7 años es competitivo
- Confirmar si ahorro mensual justifica inversión

**5. VEREDICTO FINAL:**
Resume en 2-3 oraciones si recomiendas APROBAR, AJUSTAR o REPLANTEAR 
el proyecto, y cuál es la acción inmediata sugerida.

FORMATO DE RESPUESTA:

- Usa párrafos cortos y bullets cuando sea necesario
- Lenguaje técnico pero accesible para cliente comercial/industrial
- Sé específico: menciona modelos de equipos alternativos si sugieres cambios
- Incluye números concretos en tus recomendaciones
- Tono profesional y concluyente, no especulativo`}function Q(){return localStorage.getItem("gemini_api_key")}function pa(a){localStorage.setItem("gemini_api_key",a)}function je(){const a=Q();return a!==null&&a.trim()!==""}function ua({isOpen:a,onClose:o}){const[r,c]=_.useState(""),[t,i]=_.useState(4200),[s,d]=_.useState(600),[n,l]=_.useState(!1);_.useEffect(()=>{const p=Q()||"",x=localStorage.getItem("trm")||"4200",u=localStorage.getItem("tarifa_kwh")||"600";c(p),i(parseFloat(x)),d(parseFloat(u))},[a]);const m=()=>{pa(r),localStorage.setItem("trm",t.toString()),localStorage.setItem("tarifa_kwh",s.toString()),l(!0),setTimeout(()=>{l(!1),o()},1500)};return a?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"card max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-6 h-6 text-solar-500"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Configuración"})]}),e.jsx("button",{onClick:o,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(sa,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["API Key de Gemini",e.jsx("span",{className:"text-red-400 ml-1",children:"*"})]}),e.jsx("input",{type:"password",value:r,onChange:p=>c(p.target.value),placeholder:"Ingresa tu API Key de Gemini",className:"input-field"}),e.jsx("p",{className:"text-xs text-cosmic-400 mt-1",children:"Tu API Key se almacena localmente y nunca se comparte"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TRM (Tasa Representativa del Mercado)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:t,onChange:p=>i(parseFloat(p.target.value)||0),placeholder:"4200",className:"input-field",step:"10"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-cosmic-400",children:"COP/USD"})]}),e.jsx("p",{className:"text-xs text-cosmic-400 mt-1",children:"Valor por defecto: 4200 COP/USD"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tarifa Eléctrica Promedio"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:s,onChange:p=>d(parseFloat(p.target.value)||0),placeholder:"600",className:"input-field",step:"10"}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-cosmic-400",children:"COP/kWh"})]}),e.jsx("p",{className:"text-xs text-cosmic-400 mt-1",children:"Valor por defecto: 600 COP/kWh"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:o,className:"flex-1 px-6 py-2 bg-cosmic-800 hover:bg-cosmic-700 text-white font-semibold rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:m,className:"flex-1 btn-primary flex items-center justify-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-5 h-5"}),"Guardado"]}):"Guardar"})]})]})}):null}const xa={Riohacha:6,Valledupar:6,"Santa Marta":5.5,Barranquilla:5.7,Cartagena:5.5,Montería:5.5,Sincelejo:5.5,"San Andrés":5,Cúcuta:4.5,Bucaramanga:3.5,Tunja:5,Arauca:5.3,Yopal:4.5,Villavicencio:4.5,"Puerto Carreño":5,Medellín:4.3,Manizales:4,Pereira:4,Armenia:4.3,Bogotá:3.5,Ibagué:4,Neiva:4.5,Florencia:4.5,Cali:4.5,Popayán:4,Pasto:4,Quibdó:3.5,Mocoa:3.5,Leticia:4,Mitú:4,"Puerto Inírida":4,"San José del Guaviare":4},le={hsp_colombia:xa};function ha({onCalculate:a}){const[o,r]=_.useState({nombreProyecto:"",tipoInstalacion:"residencial",ciudad:"Bogotá",tipoConexion:"on-grid",consumoMensual:"",valorFactura:"",usarFactura:!1,autonomiaPct:100,presupuestoMaximo:"",prioridad:"sostenibilidad",requiereBaterias:!1,espacioLimitado:!1}),[c,t]=_.useState({}),i=n=>{const{name:l,value:m,type:p,checked:x}=n.target;r(u=>({...u,[l]:p==="checkbox"?x:m})),c[l]&&t(u=>({...u,[l]:""}))},s=()=>{const n={};return o.nombreProyecto.trim()||(n.nombreProyecto="El nombre del proyecto es requerido"),o.usarFactura?(!o.valorFactura||parseFloat(o.valorFactura)<=0)&&(n.valorFactura="Ingresa un valor de factura válido"):(!o.consumoMensual||parseFloat(o.consumoMensual)<=0)&&(n.consumoMensual="Ingresa un consumo mensual válido"),t(n),Object.keys(n).length===0},d=n=>{if(n.preventDefault(),!s())return;let l=parseFloat(o.consumoMensual);if(o.usarFactura){const p=parseFloat(localStorage.getItem("tarifa_kwh")||"600");l=parseFloat(o.valorFactura)/p}const m={...o,consumoMensual:l,hsp:le.hsp_colombia[o.ciudad],tarifaKwh:parseFloat(localStorage.getItem("tarifa_kwh")||"600"),trm:parseFloat(localStorage.getItem("trm")||"4200")};a(m)};return e.jsxs("form",{onSubmit:d,className:"card",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center gap-2",children:[e.jsx(re,{className:"w-6 h-6 text-solar-500"}),"Datos del Proyecto"]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-cosmic-200 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-solar-500"}),"Información General"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"input-label",children:["Nombre del Proyecto ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"nombreProyecto",value:o.nombreProyecto,onChange:i,placeholder:"Ej: Sistema Solar Residencial Casa Campestre",className:`input-field ${c.nombreProyecto?"border-red-500":""}`}),c.nombreProyecto&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.nombreProyecto})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Tipo de Instalación"}),e.jsxs("select",{name:"tipoInstalacion",value:o.tipoInstalacion,onChange:i,className:"input-field",children:[e.jsx("option",{value:"residencial",children:"Residencial"}),e.jsx("option",{value:"comercial",children:"Comercial"}),e.jsx("option",{value:"industrial",children:"Industrial"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Ubicación"}),e.jsx("select",{name:"ciudad",value:o.ciudad,onChange:i,className:"input-field",children:Object.keys(le.hsp_colombia).map(n=>e.jsx("option",{value:n,children:n},n))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Tipo de Conexión"}),e.jsxs("select",{name:"tipoConexion",value:o.tipoConexion,onChange:i,className:"input-field",children:[e.jsx("option",{value:"on-grid",children:"On-Grid (Conectado a la red)"}),e.jsx("option",{value:"off-grid",children:"Off-Grid (Autónomo)"}),e.jsx("option",{value:"hibrido",children:"Híbrido"})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-cosmic-200 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5 text-solar-500"}),"Consumo Energético"]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("input",{type:"checkbox",id:"usarFactura",name:"usarFactura",checked:o.usarFactura,onChange:i,className:"w-4 h-4 text-solar-500 bg-cosmic-800 border-cosmic-600 rounded focus:ring-solar-500 accent-solar-500"}),e.jsx("label",{htmlFor:"usarFactura",className:"text-sm text-cosmic-300",children:"Calcular a partir del valor de la factura"})]}),o.usarFactura?e.jsxs("div",{children:[e.jsxs("label",{className:"input-label",children:["Valor Factura Mensual (COP) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"number",name:"valorFactura",value:o.valorFactura,onChange:i,placeholder:"Ej: 300000",className:`input-field ${c.valorFactura?"border-red-500":""}`}),c.valorFactura&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.valorFactura})]}):e.jsxs("div",{children:[e.jsxs("label",{className:"input-label",children:["Consumo Mensual (kWh) ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"number",name:"consumoMensual",value:o.consumoMensual,onChange:i,placeholder:"Ej: 500",className:`input-field ${c.consumoMensual?"border-red-500":""}`}),c.consumoMensual&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:c.consumoMensual})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"input-label",children:["Autonomía Energética Deseada: ",e.jsxs("span",{className:"text-solar-500 font-bold",children:[o.autonomiaPct,"%"]})]}),e.jsx("input",{type:"range",name:"autonomiaPct",min:"20",max:"100",step:"10",value:o.autonomiaPct,onChange:i,className:"slider w-full",style:{"--value":`${(o.autonomiaPct-20)/80*100}%`}}),e.jsxs("div",{className:"flex justify-between text-xs text-cosmic-500 mt-1",children:[e.jsx("span",{children:"20%"}),e.jsx("span",{children:"50%"}),e.jsx("span",{children:"80%"}),e.jsx("span",{children:"100%"})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-cosmic-200 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-solar-500"}),"Preferencias"]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Presupuesto Máximo (COP) - Opcional"}),e.jsx("input",{type:"number",name:"presupuestoMaximo",value:o.presupuestoMaximo,onChange:i,placeholder:"Ej: 50000000",className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Prioridad"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:["costo","calidad","sostenibilidad"].map(n=>e.jsxs("label",{className:`flex items-center justify-center p-3 rounded-xl border-2 cursor-pointer transition-all ${o.prioridad===n?"border-solar-500 bg-solar-500/10 text-solar-400":"border-cosmic-600 hover:border-cosmic-500 text-cosmic-300"}`,children:[e.jsx("input",{type:"radio",name:"prioridad",value:n,checked:o.prioridad===n,onChange:i,className:"sr-only"}),e.jsx("span",{className:"capitalize font-medium",children:n})]},n))})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"requiereBaterias",checked:o.requiereBaterias,onChange:i,className:"w-4 h-4 text-solar-500 bg-cosmic-800 border-cosmic-600 rounded focus:ring-solar-500 accent-solar-500"}),e.jsx("span",{className:"text-sm text-cosmic-300",children:"¿Requiere baterías?"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"espacioLimitado",checked:o.espacioLimitado,onChange:i,className:"w-4 h-4 text-solar-500 bg-cosmic-800 border-cosmic-600 rounded focus:ring-solar-500 accent-solar-500"}),e.jsx("span",{className:"text-sm text-cosmic-300",children:"¿Espacio limitado en techo?"})]})]})]}),e.jsxs("button",{type:"submit",className:"w-full btn-primary flex items-center justify-center gap-2",children:[e.jsx(re,{className:"w-5 h-5"}),"Calcular Configuraciones"]})]})}function ga(a,o){return a/30*(o/100)}function fa(a,o,r=.8){return a/(o*r)}function ee(a,o,r=!1){return(r?[...o].sort((i,s)=>s.eficiencia-i.eficiencia):[...o].sort((i,s)=>i.precio_cop/i.potencia_w-s.precio_cop/s.potencia_w)).map(i=>{const s=Math.ceil(a*1e3/i.potencia_w),d=s*i.potencia_w/1e3,n=s*i.dimensiones_m2,l=s*i.precio_cop;return{panel:i,numPaneles:s,potenciaReal:d,areaRequerida:n,costoTotal:l,costoPorWp:l/(d*1e3)}})[0]}function ae(a,o,r){const t=a/(o==="on-grid"?1.25:1);let i=r;return o==="hibrido"?i=r.filter(d=>d.tipo==="Híbrido"):o==="on-grid"&&(i=r.filter(d=>d.tipo==="String on-grid")),i.reduce((d,n)=>{const l=Math.abs(d.potencia_kw-t);return Math.abs(n.potencia_kw-t)<l?n:d})}function V(a,o=4200){const{numPaneles:r,panel:c,inversor:t,potenciaReal:i,requiereBaterias:s,capacidadBateria:d,bateria:n}=a,l=r*c.precio_cop,m=t.precio_cop,u=35e4+r*125e3,g=Math.ceil(r/4),M=85e4+Math.max(0,g-1)*15e4,w=45e4,f=55e4,v=25e4+r*12e4,C=Math.max(i*45e4,12e5),A=(l+m)*.12,I=8e5,T=14e5,$=i>100?25e5:0;let k=0;s&&n&&(k=Math.ceil(d/n.capacidad_kwh)*n.precio_cop);const F=l+m+u+M+w+f+v+C+A+I+T+$+k,W=F*.05,z=(F+W)*.3,B=F+W+z,q=B/(i*1e3);return{costoPaneles:l,costoInversor:m,costoBaterias:k,costoEstructura:u,costoProteccionesDC:M,costoProteccionesAC:w,costoPuestaATierra:f,costoCableado:v,costoManoObra:C,costoIngenieria:A,costoTramitesOperador:I,costoCertificacionRETIE:T,costoTramitesUPME:$,costoImprevistos:W,margenComercial:z,inversionTotal:B,costoPorWp:q,numStrings:g}}function J(a,o,r=750,c={}){const{tasaMantenimiento:t=.01,tasaDegradacion:i=.005,tasaInflacionEnergia:s=.05,vidaUtilAnos:d=25,tasaDescuento:n=.08}=c,l=o*12,m=a*t;let p=[],x=0,u=0,g=null,h=-a;for(let b=1;b<=d;b++){const v=Math.pow(1-i,b-1),E=l*v,j=Math.pow(1+s,b-1),C=r*j,A=E*C,I=m*Math.pow(1.02,b-1),T=A-I;if(x+=T,u+=I,g===null&&x>=a){const k=x-T,F=(a-k)/T;g=b-1+F}const $=Math.pow(1+n,b);h+=T/$,p.push({ano:b,energiaAnual:Math.round(E),tarifaKwh:Math.round(C),ahorroBruto:Math.round(A),costoMantenimiento:Math.round(I),ahorroNeto:Math.round(T),ahorroAcumulado:Math.round(x)})}g===null&&(g=d+1);const P=o*r,M=P*12,w=x-a,f=w/a*100,N=ba(a,p.map(b=>b.ahorroNeto));return{ahorroMensual:Math.round(P),ahorroAnual:Math.round(M),costoMantenimientoAnual:Math.round(m),tiempoRetornoAnos:Math.round(g*10)/10,ahorroTotal25Anos:Math.round(x),costoMantenimientoTotal:Math.round(u),gananciaTotal:Math.round(w),roi:Math.round(f*10)/10,vpn:Math.round(h),tir:Math.round(N*10)/10,parametros:{tasaMantenimiento:t*100,tasaDegradacion:i*100,tasaInflacionEnergia:s*100,tasaDescuento:n*100},proyeccion:p.filter(b=>b.ano<=10||b.ano===15||b.ano===20||b.ano===25)}}function ba(a,o){let r=0,c=1,t=.1;for(let i=0;i<100;i++){let s=-a;for(let d=0;d<o.length;d++)s+=o[d]/Math.pow(1+t,d+1);if(Math.abs(s)<1e3)break;s>0?(r=t,t=(t+c)/2):(c=t,t=(t+r)/2)}return t*100}function oe(a,o=2,r=80){return a*o/(r/100)}function y(a){return new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}function O(a,o=2){return new Intl.NumberFormat("es-CO",{minimumFractionDigits:o,maximumFractionDigits:o}).format(a)}function _a({configuracion:a,isRecomendada:o,onSelect:r}){const{tipo:c,descripcion:t,panel:i,numPaneles:s,potenciaReal:d,areaRequerida:n,inversor:l,bateria:m,capacidadBateria:p,presupuesto:x,roi:u,puntuacion:g}=a,h=()=>c.includes("Costo")||c.includes("Precio")?"from-blue-500 to-blue-600":c.includes("Calidad")?"from-purple-500 to-purple-600":"from-green-500 to-green-600",P=()=>c.includes("Costo")||c.includes("Precio")?"shadow-blue-500/20":c.includes("Calidad")?"shadow-purple-500/20":"shadow-green-500/20";return e.jsxs("div",{className:`card-premium hover-lift group relative overflow-hidden ${o?"ring-2 ring-solar-500 ring-offset-2 ring-offset-cosmic-950":""} ${P()}`,children:[o&&e.jsxs("div",{className:"ribbon",children:[e.jsx(ue,{className:"w-3 h-3"}),"Recomendada"]}),e.jsx("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"})}),e.jsxs("div",{className:"mb-6 relative z-10",children:[e.jsxs("div",{className:`inline-flex items-center gap-2 bg-gradient-to-r ${h()} text-white px-4 py-2 rounded-xl text-sm font-bold mb-3 shadow-lg`,children:[e.jsx(ea,{className:"w-4 h-4"}),c]}),e.jsx("p",{className:"text-cosmic-300 text-sm leading-relaxed",children:t})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-cosmic-900/50 rounded-xl border border-cosmic-700/50 hover:border-solar-500/30 transition-colors duration-300",children:[e.jsx("div",{className:"p-2 bg-solar-500/10 rounded-lg",children:e.jsx(fe,{className:"w-5 h-5 text-solar-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-white font-bold text-lg",children:[O(d,2)," kWp"]}),e.jsxs("p",{className:"text-cosmic-300 text-sm font-medium",children:[s,"x ",i.marca," ",i.modelo]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-xs text-cosmic-400",children:[i.potencia_w,"W"]}),e.jsx("span",{className:"text-xs text-cosmic-500",children:"•"}),e.jsx("span",{className:"text-xs text-cosmic-400",children:i.tecnologia}),e.jsx("span",{className:"text-xs text-cosmic-500",children:"•"}),e.jsxs("span",{className:"text-xs text-solar-400 font-semibold",children:[i.eficiencia,"% eficiencia"]})]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-cosmic-900/50 rounded-xl border border-cosmic-700/50 hover:border-energy-500/30 transition-colors duration-300",children:[e.jsx("div",{className:"p-2 bg-energy-500/10 rounded-lg",children:e.jsx(be,{className:"w-5 h-5 text-energy-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-white font-bold",children:[l.marca," ",l.modelo]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-sm text-cosmic-300",children:[l.potencia_kw,"kW"]}),e.jsx("span",{className:"text-xs text-cosmic-500",children:"•"}),e.jsxs("span",{className:"text-xs text-energy-400 font-semibold",children:[l.eficiencia,"% eficiencia"]})]}),e.jsx("p",{className:"text-xs text-cosmic-400 mt-1",children:l.tipo})]})]}),m&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-900/50 rounded-xl border border-slate-700/50 hover:border-yellow-500/30 transition-colors duration-300",children:[e.jsx("div",{className:"p-2 bg-yellow-500/10 rounded-lg",children:e.jsx(Fe,{className:"w-5 h-5 text-yellow-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-white font-bold",children:[Math.ceil(p/m.capacidad_kwh),"x ",m.marca]}),e.jsxs("p",{className:"text-slate-300 text-sm",children:[O(p,1)," kWh total"]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:m.tecnologia})]})]}),e.jsx("div",{className:"pt-3 border-t border-cosmic-700/50",children:e.jsxs("p",{className:"text-cosmic-400 text-sm",children:["Área requerida: ",e.jsxs("span",{className:"text-white font-bold",children:[O(n,1)," m²"]})]})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-cosmic-950/80 to-cosmic-900/80 rounded-xl p-5 space-y-3 mb-6 border border-cosmic-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-cosmic-300 text-sm font-medium",children:"Inversión Total"}),e.jsx("span",{className:"text-white font-bold text-lg",children:y(x.inversionTotal)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-cosmic-400 text-sm",children:"Costo por Wp"}),e.jsx("span",{className:"text-slate-200 font-semibold",children:y(x.costoPorWp)})]}),e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-cosmic-600 to-transparent my-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-cosmic-800/50 rounded-lg p-3 border border-cosmic-700/30",children:[e.jsxs("div",{className:"flex items-center gap-1 text-cosmic-400 text-xs mb-1",children:[e.jsx(Ge,{className:"w-3 h-3"}),"Retorno"]}),e.jsxs("p",{className:"text-energy-400 font-bold text-lg",children:[u.tiempoRetornoAnos," años"]})]}),e.jsxs("div",{className:"bg-cosmic-800/50 rounded-lg p-3 border border-cosmic-700/30",children:[e.jsxs("div",{className:"flex items-center gap-1 text-cosmic-400 text-xs mb-1",children:[e.jsx(ta,{className:"w-3 h-3"}),"ROI (25 años)"]}),e.jsxs("p",{className:"text-solar-400 font-bold text-lg",children:[O(u.roi,0),"%"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-green-500/10 to-emerald-500/10 rounded-lg p-3 border border-green-500/20",children:[e.jsxs("div",{className:"flex items-center gap-1 text-green-400 text-xs mb-1",children:[e.jsx(xe,{className:"w-3 h-3"}),"Ahorro Anual Estimado"]}),e.jsx("p",{className:"text-green-300 font-bold text-lg",children:y(u.ahorroAnual)})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-cosmic-300 text-sm font-medium",children:"Puntuación General"}),e.jsxs("span",{className:"text-white font-bold",children:[O(g,0),"/100"]})]}),e.jsx("div",{className:"relative w-full bg-cosmic-700/50 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`bg-gradient-to-r ${h()} h-3 rounded-full transition-all duration-1000 ease-out relative`,style:{width:`${g}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})})]}),e.jsxs("button",{onClick:r,className:"w-full btn-secondary flex items-center justify-center gap-2 group/btn",children:[e.jsx(Ke,{className:"w-5 h-5 transition-transform duration-300 group-hover/btn:scale-110"}),"Ver Detalles y Generar PDF"]})]})}function ja({configuraciones:a,datosProyecto:o,onSelectConfig:r}){if(!a||a.length===0)return null;const t=(()=>{const i=o.prioridad;return a.find(s=>s.prioridad===i)||a[0]})();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center gap-2",children:[e.jsx(ue,{className:"w-6 h-6 text-solar-500"}),"Configuraciones Optimizadas"]}),e.jsxs("p",{className:"text-cosmic-400",children:["Hemos generado ",a.length," configuraciones optimizadas para tu proyecto. La configuración recomendada según tu prioridad (",o.prioridad,") está destacada."]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:a.map((i,s)=>e.jsx(_a,{configuracion:i,isRecomendada:i.tipo===t.tipo,onSelect:()=>r(i)},s))})]})}function Na({datosProyecto:a,configuracion:o}){const[r,c]=_.useState(""),[t,i]=_.useState(!1),[s,d]=_.useState(""),n=async()=>{if(!je()){d("Por favor configura tu API Key de Gemini en el menú de configuración");return}i(!0),d("");try{const l=localStorage.getItem("gemini_api_key"),m=await ca(a,o,l);c(m)}catch(l){d(l.message||"Error al obtener recomendaciones de IA")}finally{i(!1)}};return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(D,{className:"w-6 h-6 text-solar-500"}),"Análisis con IA"]}),!r&&e.jsx("button",{onClick:n,disabled:t,className:"btn-primary flex items-center gap-2",children:t?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 animate-spin"}),"Analizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4"}),"Solicitar Análisis"]})})]}),s&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/50 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(Z,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-semibold",children:"Error"}),e.jsx("p",{className:"text-red-300 text-sm",children:s})]})]}),r&&e.jsxs("div",{className:"bg-gradient-to-br from-cosmic-800/50 to-cosmic-900/50 rounded-lg p-6 border border-cosmic-700/50",children:[e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",children:e.jsx("div",{className:"text-cosmic-300 whitespace-pre-wrap leading-relaxed",children:r})}),e.jsxs("button",{onClick:n,disabled:t,className:"mt-4 text-solar-400 hover:text-solar-300 text-sm flex items-center gap-1 transition-colors w-full md:w-auto justify-center md:justify-start",children:[e.jsx(D,{className:"w-4 h-4"}),"Generar nuevo análisis"]})]}),!r&&!s&&!t&&e.jsxs("div",{className:"text-center py-8 text-cosmic-400",children:[e.jsx(D,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:'Haz clic en "Solicitar Análisis" para obtener recomendaciones personalizadas con IA'})]})]})}ye();function va({datosProyecto:a,configuracion:o,recomendacionesIA:r}){const c=()=>{const t=new Ce,i=t.internal.pageSize.getWidth();let s=20;t.setFillColor(249,115,22),t.rect(0,0,i,60,"F"),t.setTextColor(255,255,255),t.setFontSize(28),t.setFont("helvetica","bold"),t.text("Solar Project Planner",i/2,30,{align:"center"}),t.setFontSize(14),t.setFont("helvetica","normal"),t.text("Reporte de Dimensionamiento y Presupuestación",i/2,45,{align:"center"}),s=75,t.setTextColor(0,0,0),t.setFontSize(16),t.setFont("helvetica","bold"),t.text("Información del Proyecto",14,s),s+=10,t.setFontSize(10),t.setFont("helvetica","normal");const d=[["Nombre",a.nombreProyecto],["Tipo",a.tipoInstalacion],["Ubicación",`${a.ciudad}, Colombia`],["HSP",`${a.hsp} h/día`],["Consumo Mensual",`${O(a.consumoMensual,0)} kWh`],["Autonomía Deseada",`${a.autonomiaPct}%`],["Tipo de Conexión",a.tipoConexion]];t.autoTable({startY:s,head:[],body:d,theme:"plain",styles:{fontSize:10},columnStyles:{0:{fontStyle:"bold",cellWidth:50},1:{cellWidth:"auto"}}}),s=t.lastAutoTable.finalY+15,t.setFontSize(16),t.setFont("helvetica","bold"),t.text(`Configuración: ${o.tipo}`,14,s),s+=10,t.setFontSize(10),t.setFont("helvetica","normal"),t.text(o.descripcion,14,s,{maxWidth:i-28}),s+=15,t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Especificaciones Técnicas",14,s),s+=8;const n=[["Potencia del Sistema",`${O(o.potenciaReal,2)} kWp`],["Paneles Solares",`${o.numPaneles}x ${o.panel.marca} ${o.panel.modelo}`],["Potencia por Panel",`${o.panel.potencia_w}W`],["Eficiencia",`${o.panel.eficiencia}%`],["Tecnología",o.panel.tecnologia],["Área Requerida",`${O(o.areaRequerida,1)} m²`],["Inversor",`${o.inversor.marca} ${o.inversor.modelo}`],["Potencia Inversor",`${o.inversor.potencia_kw}kW`],["Eficiencia Inversor",`${o.inversor.eficiencia}%`]];if(o.bateria){const h=Math.ceil(o.capacidadBateria/o.bateria.capacidad_kwh);n.push(["Baterías",`${h}x ${o.bateria.marca} ${o.bateria.modelo}`],["Capacidad Total",`${O(o.capacidadBateria,1)} kWh`],["Tecnología Batería",o.bateria.tecnologia])}t.autoTable({startY:s,head:[],body:n,theme:"striped",styles:{fontSize:9},columnStyles:{0:{fontStyle:"bold",cellWidth:70},1:{cellWidth:"auto"}}}),s=t.lastAutoTable.finalY+15,s>240&&(t.addPage(),s=20),t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Análisis Financiero",14,s),s+=8;const l=o.presupuesto,m=[["Paneles Solares",y(l.costoPaneles)],["Inversor",y(l.costoInversor)],["Estructura de Montaje",y(l.costoEstructura)],["Protecciones DC (Caja/DPS/Fusibles)",y(l.costoProteccionesDC)],["Protecciones AC (Tablero/Breaker/DPS)",y(l.costoProteccionesAC)],["Puesta a Tierra RETIE",y(l.costoPuestaATierra)],["Cableado Fotovoltaico",y(l.costoCableado)],["Mano de Obra Instalación",y(l.costoManoObra)],["Ingeniería y Diseño",y(l.costoIngenieria)],["Trámites Operador de Red",y(l.costoTramitesOperador)],["Certificación RETIE",y(l.costoCertificacionRETIE)]];l.costoBaterias>0&&m.push(["Baterías",y(l.costoBaterias)]),l.costoTramitesUPME>0&&m.push(["Trámites UPME",y(l.costoTramitesUPME)]),m.push(["Imprevistos y Logística (5%)",y(l.costoImprevistos)]),m.push(["Gestión Comercial y Administrativa",y(l.margenComercial)]),m.push(["INVERSIÓN TOTAL",y(l.inversionTotal)]),m.push(["Costo por Wp",y(l.costoPorWp)]),t.autoTable({startY:s,head:[],body:m,theme:"striped",styles:{fontSize:9},columnStyles:{0:{fontStyle:"bold",cellWidth:70},1:{cellWidth:"auto",halign:"right"}},didParseCell:function(h){h.row.index===m.length-2&&(h.cell.styles.fillColor=[249,115,22],h.cell.styles.textColor=[255,255,255],h.cell.styles.fontStyle="bold")}}),s=t.lastAutoTable.finalY+15,t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Retorno de Inversión",14,s),s+=8;const p=o.roi,x=[["Ahorro Mensual",y(p.ahorroMensual)],["Ahorro Anual",y(p.ahorroAnual)],["Tiempo de Retorno",`${p.tiempoRetornoAnos} años`],["Ahorro Total (25 años)",y(p.ahorroTotal25Anos)],["Ganancia Total",y(p.gananciaTotal)],["ROI",`${O(p.roi,1)}%`]];if(t.autoTable({startY:s,head:[],body:x,theme:"plain",styles:{fontSize:10},columnStyles:{0:{fontStyle:"bold",cellWidth:70},1:{cellWidth:"auto",halign:"right"}}}),r){t.addPage(),s=20,t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Recomendaciones de IA",14,s),s+=10,t.setFontSize(9),t.setFont("helvetica","normal");const h=t.splitTextToSize(r,i-28);t.text(h,14,s)}const u=t.internal.getNumberOfPages();for(let h=1;h<=u;h++)t.setPage(h),t.setFontSize(8),t.setTextColor(128,128,128),t.text(`Página ${h} de ${u} | Generado el ${new Date().toLocaleDateString("es-CO")}`,i/2,t.internal.pageSize.getHeight()-10,{align:"center"});const g=`${a.nombreProyecto.replace(/\s+/g,"_")}_${o.tipo.replace(/\s+/g,"_")}.pdf`;t.save(g)};return e.jsxs("button",{onClick:c,className:"btn-primary flex items-center justify-center gap-2 w-full md:w-auto",children:[e.jsx(qe,{className:"w-5 h-5"}),"Descargar PDF"]})}function de(a,o){const{consumoMensual:r,autonomiaPct:c,hsp:t,tipoConexion:i,requiereBaterias:s,espacioLimitado:d,presupuestoMaximo:n,tarifaKwh:l}=a,{paneles:m,inversores:p,baterias:x}=o,u=ga(r,c),g=fa(u,t),h=[];return h.push(ya(g,u,i,s,d,l,m,p,x)),h.push(Ca(g,u,i,s,d,l,m,p,x)),h.push(Pa(g,u,i,s,d,l,m,p,x)),n&&n>0?h.filter(P=>P.presupuesto.inversionTotal<=n):h}function ya(a,o,r,c,t,i,s,d,n){const l=[...s].sort((w,f)=>w.precio_cop/w.potencia_w-f.precio_cop/f.potencia_w),m=ee(a,l,t),p=ae(m.potenciaReal,r,d);let x=null,u=0;c&&(u=oe(o),x=[...n].sort((w,f)=>w.precio_cop/w.capacidad_kwh-f.precio_cop/f.capacidad_kwh)[0]);const g={...m,inversor:p,requiereBaterias:c,capacidadBateria:u,bateria:x},h=V(g),P=m.potenciaReal*30*o/a,M=J(h.inversionTotal,P,i);return{tipo:"Optimizado por Costo",descripcion:"Minimiza la inversión inicial con componentes económicos de calidad",prioridad:"costo",...m,inversor:p,bateria:x,capacidadBateria:u,presupuesto:h,roi:M,puntuacion:wa(h)}}function Ca(a,o,r,c,t,i,s,d,n){const l=[...s].sort((f,N)=>{const b=f.eficiencia+(f.tecnologia.includes("N-Type")||f.tecnologia.includes("TOPCon")?2:0);return N.eficiencia+(N.tecnologia.includes("N-Type")||N.tecnologia.includes("TOPCon")?2:0)-b}),m=ee(a,l,t),p=d.filter(f=>f.marca==="Fronius"||f.marca==="SMA"),x=ae(m.potenciaReal,r,p.length>0?p:d);let u=null,g=0;c&&(g=oe(o),u=[...n].sort((f,N)=>N.ciclos_vida-f.ciclos_vida)[0]);const h={...m,inversor:x,requiereBaterias:c,capacidadBateria:g,bateria:u},P=V(h),M=m.potenciaReal*30*o/a,w=J(P.inversionTotal,M,i);return{tipo:"Optimizado por Calidad",descripcion:"Máxima eficiencia con componentes premium y mayor garantía",prioridad:"calidad",...m,inversor:x,bateria:u,capacidadBateria:g,presupuesto:P,roi:w,puntuacion:Sa(m,x,u)}}function Pa(a,o,r,c,t,i,s,d,n){const l=[...s].sort((f,N)=>{const b=f.eficiencia*f.garantia_anos/(f.precio_cop/f.potencia_w);return N.eficiencia*N.garantia_anos/(N.precio_cop/N.potencia_w)-b}),m=ee(a,l,t),p=[...d].sort((f,N)=>N.eficiencia-f.eficiencia),x=ae(m.potenciaReal,r,p);let u=null,g=0;c&&(g=oe(o),u=[...n].sort((f,N)=>{const b=f.ciclos_vida/(f.precio_cop/f.capacidad_kwh);return N.ciclos_vida/(N.precio_cop/N.capacidad_kwh)-b})[0]);const h={...m,inversor:x,requiereBaterias:c,capacidadBateria:g,bateria:u},P=V(h),M=m.potenciaReal*30*o/a,w=J(P.inversionTotal,M,i);return{tipo:"Optimizado por Sostenibilidad",descripcion:"Mejor retorno de inversión con balance costo-beneficio óptimo",prioridad:"sostenibilidad",...m,inversor:x,bateria:u,capacidadBateria:g,presupuesto:P,roi:w,puntuacion:Aa(P,w)}}function wa(a,o){return 100-a.costoPorWp/50}function Sa(a,o,r){let c=a.panel.eficiencia*4;return c+=o.eficiencia-95,r&&(c+=r.ciclos_vida/6e3*10),Math.min(100,c)}function Aa(a,o){const r=Math.min(50,o.roi/10),c=Math.max(0,50-o.tiempoRetornoAnos*5);return r+c}const Ma=[{id:1,marca:"Jinko Solar",modelo:"Tiger Neo 570W",potencia_w:570,eficiencia:22,tecnologia:"Monocristalino N-Type",precio_cop:357e3,garantia_anos:25,dimensiones_m2:2.56,tier:1,nota:"Precio estimado, marca Tier 1 disponible en Colombia"},{id:2,marca:"Trina Solar",modelo:"Vertex S+ 425W",potencia_w:425,eficiencia:21.3,tecnologia:"Monocristalino PERC",precio_cop:273e3,garantia_anos:25,dimensiones_m2:2.09,tier:1,nota:"Trina Solar líder en Colombia 2026"},{id:3,marca:"Canadian Solar",modelo:"HiKu6 550W",potencia_w:550,eficiencia:21.8,tecnologia:"Monocristalino PERC",precio_cop:336e3,garantia_anos:25,dimensiones_m2:2.47,tier:1,nota:"Marca Tier 1 popular en proyectos colombianos"},{id:4,marca:"JA Solar",modelo:"JAM72S30 540W",potencia_w:540,eficiencia:21.5,tecnologia:"Monocristalino PERC",precio_cop:315e3,garantia_anos:25,dimensiones_m2:2.46,tier:1,nota:"Precio ajustado, disponible en Colombia"},{id:5,marca:"LONGi",modelo:"Hi-MO 5 535W",potencia_w:535,eficiencia:21.6,tecnologia:"Monocristalino PERC",precio_cop:325e3,garantia_anos:25,dimensiones_m2:2.43,tier:1,nota:"LONGi marca premium disponible en Colombia"},{id:6,marca:"Risen Energy",modelo:"RSM144-6-400M",potencia_w:400,eficiencia:20.5,tecnologia:"Monocristalino PERC",precio_cop:252e3,garantia_anos:25,dimensiones_m2:1.92,tier:1,nota:"Opción económica Tier 1"},{id:7,marca:"Jinko Solar",modelo:"Tiger Pro 580W",potencia_w:580,eficiencia:22.3,tecnologia:"Monocristalino TOPCon",precio_cop:378e3,garantia_anos:30,dimensiones_m2:2.56,tier:1,nota:"Tecnología TOPCon de última generación"},{id:8,marca:"Canadian Solar",modelo:"BiHiKu7 580W",potencia_w:580,eficiencia:22.5,tecnologia:"Bifacial N-Type",precio_cop:399e3,garantia_anos:30,dimensiones_m2:2.53,tier:1,nota:"Tecnología bifacial premium"},{id:9,marca:"Trina Solar",modelo:"Vertex N 430W",potencia_w:430,eficiencia:22.1,tecnologia:"Monocristalino N-Type",precio_cop:294e3,garantia_anos:25,dimensiones_m2:1.91,tier:1,nota:"Excelente para proyectos residenciales"},{id:10,marca:"LONGi",modelo:"Hi-MO 6 575W",potencia_w:575,eficiencia:22.4,tecnologia:"Monocristalino TOPCon",precio_cop:367e3,garantia_anos:30,dimensiones_m2:2.52,tier:1,nota:"Alta eficiencia con tecnología TOPCon"},{id:11,marca:"JA Solar",modelo:"Deep Blue 3.0 565W",potencia_w:565,eficiencia:21.8,tecnologia:"Monocristalino PERC 144 celdas",precio_cop:328e3,garantia_anos:25,dimensiones_m2:2.48,tier:1,nota:"Precio verificado Suenergía Colombia enero 2026"},{id:12,marca:"Trina Solar",modelo:"Vertex 570W Bifacial",potencia_w:570,eficiencia:21.6,tecnologia:"Monocristalino Bifacial",precio_cop:449280,garantia_anos:25,dimensiones_m2:2.58,tier:1,nota:"Precio verificado Emergente Colombia 2026"},{id:13,marca:"Trina Solar",modelo:"Vertex 615W",potencia_w:615,eficiencia:21.7,tecnologia:"Monocristalino 132 media celda",precio_cop:478e3,garantia_anos:30,dimensiones_m2:2.78,tier:1,nota:"Modelo de alta potencia disponible en Colombia"},{id:14,marca:"LONGi",modelo:"Hi-MO 6 575W",potencia_w:575,eficiencia:22.2,tecnologia:"Monocristalino TOPCon",precio_cop:597200,garantia_anos:25,dimensiones_m2:2.52,tier:1,nota:"Precio verificado Sunny Future enero 2026"},{id:15,marca:"Jinko Solar",modelo:"Tiger Pro 585W N-Type",potencia_w:585,eficiencia:22.5,tecnologia:"Monocristalino N-Type TOPCon",precio_cop:565250,garantia_anos:30,dimensiones_m2:2.56,tier:1,nota:"Tecnología de última generación disponible"},{id:16,marca:"Trina Solar",modelo:"Vertex 700W",potencia_w:700,eficiencia:22.8,tecnologia:"Monocristalino N-Type",precio_cop:685e3,garantia_anos:30,dimensiones_m2:3.02,tier:1,nota:"Panel de máxima potencia para proyectos comerciales"}],Ea={paneles:Ma},Ia=[{id:1,marca:"Fronius",modelo:"Primo 8.2-1",potencia_kw:8.2,tipo:"String on-grid",eficiencia:98,precio_cop:504e4,voltaje_mppt_min:80,voltaje_mppt_max:800,garantia_anos:10,nota:"Precio estimado - Fronius disponible en Colombia"},{id:2,marca:"Huawei",modelo:"SUN2000-5KTL-L1",potencia_kw:5,tipo:"String on-grid",eficiencia:97.6,precio_cop:273e4,voltaje_mppt_min:90,voltaje_mppt_max:560,garantia_anos:10,nota:"Precio verificado en mercado colombiano"},{id:3,marca:"SMA",modelo:"Sunny Boy 3.0",potencia_kw:3,tipo:"String on-grid",eficiencia:97,precio_cop:189e4,voltaje_mppt_min:80,voltaje_mppt_max:550,garantia_anos:10,nota:"SMA disponible a través de Meico Solar Colombia"},{id:4,marca:"Growatt",modelo:"MIN 6000TL-XH",potencia_kw:6,tipo:"String on-grid",eficiencia:98.3,precio_cop:252e4,voltaje_mppt_min:80,voltaje_mppt_max:550,garantia_anos:10,nota:"Growatt líder en ventas mundial 3 años consecutivos"},{id:5,marca:"Solis",modelo:"S6-GR1P10K",potencia_kw:10,tipo:"String on-grid",eficiencia:98.1,precio_cop:42e5,voltaje_mppt_min:100,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Precio estimado mercado colombiano"},{id:6,marca:"Goodwe",modelo:"GW15K-DT",potencia_kw:15,tipo:"String on-grid",eficiencia:98.5,precio_cop:63e5,voltaje_mppt_min:200,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Goodwe disponible en distribuidores colombianos"},{id:7,marca:"Huawei",modelo:"SUN2000-20KTL-M2",potencia_kw:20,tipo:"String on-grid",eficiencia:98.6,precio_cop:84e5,voltaje_mppt_min:200,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Modelo disponible, precio verificado"},{id:8,marca:"Growatt",modelo:"SPH 5000 Hybrid",potencia_kw:5,tipo:"Híbrido",eficiencia:97.5,precio_cop:462e4,voltaje_mppt_min:100,voltaje_mppt_max:550,garantia_anos:10,nota:"Certificado UL1741 y IEEE1547 para Colombia"},{id:9,marca:"Fronius",modelo:"Symo 12.5-3-M",potencia_kw:12.5,tipo:"String on-grid",eficiencia:98.1,precio_cop:588e4,voltaje_mppt_min:150,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Fronius opera en Colombia con división Solar Energy"},{id:10,marca:"SMA",modelo:"Sunny Tripower 25000TL",potencia_kw:25,tipo:"String on-grid",eficiencia:98.4,precio_cop:105e5,voltaje_mppt_min:320,voltaje_mppt_max:800,garantia_anos:10,nota:"Distribuido por Meico Solar en Colombia"},{id:11,marca:"Huawei",modelo:"SUN2000-6KTL-M1",potencia_kw:6,tipo:"String on-grid",eficiencia:97.5,precio_cop:6641791,voltaje_mppt_min:90,voltaje_mppt_max:600,garantia_anos:5,nota:"Precio actualizado enero 2026 AutoSolar Colombia"},{id:12,marca:"Deye",modelo:"Híbrido 10K Trifásico HV",potencia_kw:10,tipo:"Híbrido",eficiencia:97,precio_cop:13889e3,voltaje_mppt_min:160,voltaje_mppt_max:500,garantia_anos:10,nota:"Marca emergente popular en Colombia 2026"},{id:13,marca:"Deye",modelo:"Híbrido 15K Trifásico HV",potencia_kw:15,tipo:"Híbrido",eficiencia:97,precio_cop:1535e4,voltaje_mppt_min:160,voltaje_mppt_max:500,garantia_anos:10,nota:"Alta eficiencia para proyectos comerciales"},{id:14,marca:"Growatt",modelo:"MAC 15KTL3-XL",potencia_kw:15,tipo:"String on-grid",eficiencia:98.5,precio_cop:9627220,voltaje_mppt_min:200,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Precio verificado AutoSolar Colombia"},{id:15,marca:"Growatt",modelo:"MAX 75KTL3-XL",potencia_kw:75,tipo:"String on-grid",eficiencia:98.7,precio_cop:24622119,voltaje_mppt_min:250,voltaje_mppt_max:1e3,garantia_anos:10,nota:"Para grandes proyectos comerciales e industriales"},{id:16,marca:"Huawei",modelo:"SUN2000-100KTL",potencia_kw:100,tipo:"String on-grid",eficiencia:98.7,precio_cop:2268e4,voltaje_mppt_min:200,voltaje_mppt_max:1e3,garantia_anos:5,nota:"Para proyectos industriales de gran escala"}],Ta={inversores:Ia},Oa=[{id:1,marca:"BYD",modelo:"Battery-Box Premium LVS 12.0",capacidad_kwh:12,tecnologia:"LiFePO4 (LFP)",precio_cop:"9000000 - 11000000",voltaje_nominal:51.2,ciclos_vida:6e3,garantia_anos:10,profundidad_descarga:90,nota:"Modelo disponible en Colombia, precio estimado entre 9-11 millones COP"},{id:2,marca:"Pylontech",modelo:"US3000C",capacidad_kwh:3.55,tecnologia:"LiFePO4 (LFP)",precio_cop:"2800000 - 3200000",voltaje_nominal:48,ciclos_vida:6e3,garantia_anos:10,profundidad_descarga:95,nota:"Precio referencial basado en mercado europeo convertido"},{id:3,marca:"Huawei",modelo:"LUNA2000-10-S0",capacidad_kwh:10,tecnologia:"Litio-Ion",precio_cop:"8000000 - 10000000",voltaje_nominal:600,ciclos_vida:5e3,garantia_anos:10,profundidad_descarga:100,nota:"Modelo disponible en Colombia, precio estimado 8-10 millones COP"},{id:4,marca:"Pylontech",modelo:"US5000",capacidad_kwh:4.8,tecnologia:"LiFePO4 (LFP)",precio_cop:"3800000 - 4500000",voltaje_nominal:48,ciclos_vida:6e3,garantia_anos:10,profundidad_descarga:95,nota:"Precio estimado por capacidad vs US3000C"},{id:5,marca:"BYD",modelo:"Battery-Box Premium HVS 10.2",capacidad_kwh:10.24,tecnologia:"LiFePO4 (LFP)",precio_cop:"8000000 - 9000000",voltaje_nominal:512,ciclos_vida:6e3,garantia_anos:10,profundidad_descarga:90,nota:"Modelo disponible en Colombia, precio estimado 8-9 millones COP"},{id:6,marca:"Goodwe",modelo:"Lynx Home F G2 13.8",capacidad_kwh:13.8,tecnologia:"LiFePO4 (LFP)",precio_cop:"Consultar distribuidor",voltaje_nominal:358,ciclos_vida:6e3,garantia_anos:10,profundidad_descarga:90,nota:"Información limitada en mercado colombiano"}],Ra={baterias:Oa};function ka(){const[a,o]=_.useState(!1),[r,c]=_.useState(!1),[t,i]=_.useState(null),[s,d]=_.useState([]),[n,l]=_.useState(null),[m,p]=_.useState(""),[x,u]=_.useState(!1),[g,h]=_.useState(null),[P,M]=_.useState("");_.useEffect(()=>{!localStorage.getItem("has_seen_setup")&&!je()&&(c(!0),o(!0))},[]);const w=()=>{o(!1),r&&(localStorage.setItem("has_seen_setup","true"),c(!1))},f=async v=>{i(v),u(!0),h(null),d([]),l(null),p(""),M("");const E={paneles:Ea.paneles,inversores:Ta.inversores,baterias:Ra.baterias},j=Q();if(j)try{const C=await la(v,E,j);console.log("Respuesta IA:",C);const A=[];if(C.configuracionCalidad){const I=N(C.configuracionCalidad,v);A.push(I)}if(C.configuracionEconomica){const I=N(C.configuracionEconomica,v);A.push(I)}d(A),M(C.comparativaHTML||"")}catch(C){console.error("Error generando configuraciones IA:",C),h("Error al generar configuraciones con IA. Usando cálculo manual.");const A=de(v,E);d(A)}else{const C=de(v,E);d(C)}u(!1),setTimeout(()=>{document.getElementById("results")?.scrollIntoView({behavior:"smooth"})},100)},N=(v,E)=>{const j=(R,U=0)=>{if(R==null)return U;const K=typeof R=="string"?parseFloat(R):Number(R);return isNaN(K)?U:K},{panel:C,inversor:A,numPaneles:I,potenciaReal:T,justificacionHTML:$,tipo:k,prioridad:F,areaRequerida:W,puntuacion:z}=v,B={...C,potencia_w:j(C?.potencia_w,450),eficiencia:j(C?.eficiencia,20),precio_cop:j(C?.precio_cop,25e4),garantia_anos:j(C?.garantia_anos,25),dimensiones_m2:j(C?.dimensiones_m2,2.5)},q={...A,potencia_kw:j(A?.potencia_kw,5),eficiencia:j(A?.eficiencia,97),precio_cop:j(A?.precio_cop,3e6),garantia_anos:j(A?.garantia_anos,10)},G=j(I,10),Ne=j(T,G*B.potencia_w/1e3),L={tipo:k||"Configuración IA",prioridad:F||"calidad",panel:B,numPaneles:G,potenciaReal:Ne,inversor:q,requiereBaterias:!1,capacidadBateria:0,bateria:null,justificacionHTML:$||"",areaRequerida:j(W,G*2.5),puntuacion:j(z,75)};try{L.presupuesto=V(L);const R=j(L.presupuesto?.inversionTotal,1e7),U=j(E.consumoMensual,500)*j(E.autonomiaPct,100)/100,K=j(E.tarifaKwh,750);L.roi=J(R,U,K)}catch(R){console.error("Error calculando presupuesto/ROI:",R),L.presupuesto={inversionTotal:1e7,costoPorWp:4500,costoPaneles:B.precio_cop*G,costoInversor:q.precio_cop,costoEstructura:0,costoProteccionesDC:0,costoProteccionesAC:0,costoPuestaATierra:0,costoCableado:0,costoManoObra:0,costoIngenieria:0,costoTramitesOperador:0,costoCertificacionRETIE:0,costoBaterias:0,costoImprevistos:0,margenComercial:0},L.roi={ahorroMensual:0,ahorroAnual:0,tiempoRetornoAnos:0,roi:0,gananciaTotal:0,vpn:0,tir:0}}return L},b=v=>{l(v),p(""),setTimeout(()=>{document.getElementById("details")?.scrollIntoView({behavior:"smooth"})},100)};return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(ra,{onOpenSettings:()=>o(!0)}),e.jsx(ua,{isOpen:a,onClose:w}),e.jsxs("main",{className:"container mx-auto px-4 py-6 md:py-8 space-y-6 md:space-y-8 pb-12",children:[r&&e.jsx("div",{className:"card bg-gradient-to-r from-solar-500/10 to-solar-600/10 border-solar-500/50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Z,{className:"w-6 h-6 text-solar-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"¡Bienvenido a Solar Project Planner!"}),e.jsx("p",{className:"text-cosmic-300 mb-2",children:"Para comenzar, por favor configura tu API Key de Gemini en el modal de configuración que se acaba de abrir."}),e.jsxs("p",{className:"text-cosmic-400 text-sm",children:["Puedes obtener una API Key gratuita en"," ",e.jsx("a",{href:"https://makersuite.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-solar-400 hover:text-solar-300 underline",children:"Google AI Studio"})]})]})]})}),e.jsx(ha,{onCalculate:f}),x&&e.jsx("div",{className:"card bg-gradient-to-r from-solar-500/10 to-solar-600/10 border-solar-500/30",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(he,{className:"w-8 h-8 text-solar-500 animate-spin"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-solar-400"}),"Generando configuraciones con IA..."]}),e.jsx("p",{className:"text-cosmic-400",children:"Analizando catálogos y optimizando para tu proyecto"})]})]})}),g&&e.jsx("div",{className:"card bg-red-500/10 border-red-500/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Z,{className:"w-6 h-6 text-red-400"}),e.jsx("p",{className:"text-red-300",children:g})]})}),P&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-solar-400"}),"Comparativa de Opciones (Generada por IA)"]}),e.jsx("div",{className:"prose prose-invert max-w-none [&_table]:w-full [&_table]:border-collapse [&_th]:bg-cosmic-800 [&_th]:p-3 [&_th]:text-left [&_td]:p-3 [&_td]:border-b [&_td]:border-cosmic-700",dangerouslySetInnerHTML:{__html:P}})]}),s.length>0&&e.jsx("div",{id:"results",children:e.jsx(ja,{configuraciones:s,datosProyecto:t,onSelectConfig:b})}),n&&e.jsxs("div",{id:"details",className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Detalles de la Configuración"}),e.jsxs("p",{className:"text-cosmic-400",children:[n.tipo," - ",n.descripcion]})]}),e.jsx(va,{datosProyecto:t,configuracion:n,recomendacionesIA:m})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Desglose de Costos"}),e.jsx("div",{className:"space-y-2 text-sm",children:Object.entries({"Paneles Solares":n.presupuesto.costoPaneles,Inversor:n.presupuesto.costoInversor,"Estructura de Montaje":n.presupuesto.costoEstructura,"Protecciones DC (Caja/DPS/Fusibles)":n.presupuesto.costoProteccionesDC,"Protecciones AC (Tablero/Breaker/DPS)":n.presupuesto.costoProteccionesAC,"Puesta a Tierra RETIE":n.presupuesto.costoPuestaATierra,"Cableado Fotovoltaico":n.presupuesto.costoCableado,"Mano de Obra":n.presupuesto.costoManoObra,"Ingeniería y Diseño":n.presupuesto.costoIngenieria,"Trámites Operador de Red":n.presupuesto.costoTramitesOperador,"Certificación RETIE":n.presupuesto.costoCertificacionRETIE,...n.presupuesto.costoBaterias>0&&{Baterías:n.presupuesto.costoBaterias},...n.presupuesto.costoTramitesUPME>0&&{"Trámites UPME":n.presupuesto.costoTramitesUPME},"Imprevistos y Logística (5%)":n.presupuesto.costoImprevistos,"Gestión Comercial y Administrativa":n.presupuesto.margenComercial}).map(([v,E])=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-cosmic-700",children:[e.jsx("span",{className:"text-cosmic-400",children:v}),e.jsx("span",{className:"text-white font-semibold",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(E)})]},v))})]}),n.justificacionHTML&&e.jsx("div",{className:"col-span-1 md:col-span-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-solar-500/10 to-solar-600/10 border border-solar-500/30 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-solar-400"}),"¿Por qué esta configuración?"]}),e.jsx("div",{className:"prose prose-sm prose-invert max-w-none [&_p]:mb-2 [&_ul]:list-disc [&_ul]:pl-5 [&_li]:mb-1 [&_strong]:text-solar-400",dangerouslySetInnerHTML:{__html:n.justificacionHTML}})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Proyección de Ahorros"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-500/10 to-green-600/10 border border-green-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-green-400 text-xs mb-1",children:"Ahorro Mensual (Año 1)"}),e.jsx("p",{className:"text-white text-lg font-bold",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(n.roi.ahorroMensual)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/10 to-blue-600/10 border border-blue-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-blue-400 text-xs mb-1",children:"Retorno de Inversión"}),e.jsxs("p",{className:"text-white text-lg font-bold",children:[n.roi.tiempoRetornoAnos," años"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-solar-500/10 to-solar-600/10 border border-solar-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-solar-400 text-xs mb-1",children:"Ahorro Anual (Año 1)"}),e.jsx("p",{className:"text-white text-lg font-bold",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(n.roi.ahorroAnual)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-500/10 to-red-600/10 border border-red-500/30 rounded-lg p-3",children:[e.jsx("p",{className:"text-red-400 text-xs mb-1",children:"Mantenimiento Anual"}),e.jsx("p",{className:"text-white text-lg font-bold",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(n.roi.costoMantenimientoAnual||0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-solar-500/10 to-solar-600/10 border border-solar-500/30 rounded-lg p-3 col-span-2",children:[e.jsx("p",{className:"text-solar-400 text-xs mb-1",children:"Ganancia Total Neta (25 años)"}),e.jsx("p",{className:"text-white text-xl font-bold",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(n.roi.gananciaTotal)}),e.jsxs("p",{className:"text-cosmic-400 text-xs mt-1",children:["ROI: ",n.roi.roi,"% | VPN: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(n.roi.vpn||0)," | TIR: ",n.roi.tir||0,"%"]})]})]}),e.jsxs("p",{className:"text-cosmic-500 text-xs mt-3",children:["* Incluye: degradación ",n.roi.parametros?.tasaDegradacion||.5,"%/año, inflación energía ",n.roi.parametros?.tasaInflacionEnergia||5,"%/año"]})]})]})]}),e.jsx(Na,{datosProyecto:t,configuracion:n})]})]}),e.jsx("footer",{className:"bg-dark-500/50 border-t border-cosmic-700/50 mt-auto py-6 md:py-8",children:e.jsxs("div",{className:"container mx-auto px-4 text-center",children:[e.jsx("p",{className:"text-cosmic-400 text-xs md:text-sm",children:"Solar Project Planner © 2026"}),e.jsx("p",{className:"text-cosmic-500 text-[10px] md:text-xs mt-1",children:"Dimensionamiento Solar Inteligente"})]})})]})}Ae.createRoot(document.getElementById("root")).render(e.jsx(_.StrictMode,{children:e.jsx(ka,{})}));
